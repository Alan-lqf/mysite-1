{% extends "mysite/base.html" %}
{% load static %}
{% load crispy_forms_tags %}


{% block title %}
    Blogs
{% endblock %}


{% block additional_head %}
    <!-- Custom CSS -->
    <link href="{% static 'blogs/blog-home.css' %}" rel="stylesheet">
    {% if anchor %}
    <script type='text/javascript'>
        $(document).ready(function(){
            window.location = '#{{ anchor }}'
        });
    </script>
    {% endif %}
{% endblock %}


{% block content %}
    <!-- Page Content -->

    <h1 class="page-header">
        Dark♂Blogs
        <small>乖乖站♂好</small>
    </h1>

    <!--List a list of blogs-->
    {% for blog in blogs %}

    <h2>
        <a href="{% url 'blogs:archive' blog.id %}">{{ blog.title }}</a>
    </h2>
    <p class="lead">
        by <a href="#">{{ blog.author }}</a>
    </p>
    <p><span class="glyphicon glyphicon-time"></span> Posted on {{ blog.publish_time }}</p>
    {% if blog.blogcategory_set.all.count is not 0 %}
    <p>
        Category:
        {% for category in blog.blogcategory_set.all %}
        {{ category }}
        {% endfor %}
    </p>
    {% endif %}
    <br/>
    <!--<img class="img-responsive" src="http://placehold.it/900x300" alt="">-->
    <!--<hr>-->
    <p class="lead">{{ blog.text|linebreaksbr }}</p>
    <a class="btn btn-primary" href="{% url 'blogs:archive' blog.id %}">Read More <span class="glyphicon glyphicon-chevron-right"></span></a>
    <hr/>

    {% endfor %}

    <!-- Pager -->
    <ul class="pager">
        <li class="previous" style="visibility: {% if page > 1 %}visible{% else %}hidden{% endif %}">
            <a href="{% url 'blogs:page_show' page|add:-1 %}">&larr; Older</a>
        </li>

        {% for i in page_list %}
            {% if i != '...' %}
                {% if i != page|stringformat:"i" %}
                    <a class="btn btn-default" href="{% url 'blogs:page_show' i %}">{{ i }}</a>
                {% else %}
                    <a class="btn btn-info" href="{% url 'blogs:page_show' i %}">{{ i }}</a>
                {% endif %}
            {% else %}
                <spam>...</spam>
            {% endif %}
        {% endfor %}

        <li class="next" style="visibility: {% if page < page_list|length %}visible{% else %}hidden{% endif %}">
            <a href="{% url 'blogs:page_show' page|add:1 %}">Newer &rarr;</a>
        </li>
    </ul>




    {% if user.is_authenticated %}
    <form id="post_form" method="POST" action="">
        {% csrf_token %}
        {{ form|crispy }}
        <input type="submit" class="btn btn-primary" value="Submit" />
    </form>
    {% else %}
    <p class="lead">Please log in to post a blog.</p>
    {% endif %}


{% endblock %}
